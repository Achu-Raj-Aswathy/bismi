<%- include('./partials/header') %>
<%- include('./partials/userHeader') %>

<!-- **************** MAIN CONTENT START **************** -->
<main>

    <!-- =======================
    Main banner START -->
    <section class="pt-0">
        <div class="container">
            <!-- Hero banner START -->
            <div class="row">
                <div class="col-12">
                    <!-- Card START -->
                    <div class="card card-body bg-primary justify-content-center text-center px-4 px-sm-5 pt-6 pt-md-8 pb-8" style="background-image: url(/assets/images/element/bg-pattern.png); background-position: center center; background-repeat: no-repeat; background-size: cover;">
                        <!-- Title -->
                        <h1 class="fs-2 text-white mb-4">Support Ticket</h1>
                        <p class="text-white">Here are all of your support request that you already sent.</p>                        
                    </div>
                    <!-- Card END -->
                </div>
            </div>
            <!-- Hero banner END -->
    
            <!-- Topics START -->
          <div class="row g-4 mt-3 mb-3">
  <div class="col-10 col-lg-11 col-xl-10 mx-auto">
    <div class="table-responsive">
      <table class="table table-bordered table-striped align-middle text-center">
        <thead class="table-dark">
          <tr>
            <th>Ticket ID</th>
            <th>Subject</th>
            <th>Submitted</th>
            <th>Replied</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <% tickets.forEach(ticket => { 
               let reply;
               let status;
               if (ticket.reply.length > 0) {
                 reply = ticket.reply[ticket.reply.length - 1].message;
                 status = "Completed";
               } else {
                 reply = "No reply yet";
                 status = "Pending";
               }
          %>
            <tr>
              <td><%= ticket.enquiryId %></td>
              <td><%= ticket.subject %></td>
              <td><%= ticket.message %></td>
              <td><%= reply %></td>
              <td>
                <span class="badge <%= status === 'Completed' ? 'bg-success' : 'bg-warning text-dark' %>">
                  <%= status %>
                </span>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>

            <!-- Topics END -->
    
        </div>
    </section>
    <!-- =======================
    Main banner END -->
    
    <!-- =======================
    Action boxes END -->
    <section class="pt-0 pt-lg-5">
        <div class="container">
            <div class="row g-4">
                <!-- Action box item -->
                <div class="col-md-6 position-relative overflow-hidden">
                    <div class="bg-primary bg-opacity-10 rounded-3 h-100 p-4">
                        <!-- Content -->
                        <div class="d-flex">
                            <!-- Icon -->
                            <div class="icon-lg text-white bg-primary rounded-circle flex-shrink-0"><i class="bi bi-headset"></i></div>
                            <!-- Content -->
                            <div class="ms-3">
                                <h4 class="mb-1">Contact Support?</h4>
                                <p class="mb-3">Not finding the help you need?</p>
                                <a href="/help-contact" class="btn btn-dark mb-0">Contact Us</a>
                            </div>	
                        </div>
                    </div>
                </div>
    
                <!-- Action box item -->
                <div class="col-md-6 position-relative overflow-hidden">
                    <div class="bg-secondary bg-opacity-10 rounded-3 h-100 p-4">
                        <!-- Content -->
                        <div class="d-flex">
                            <!-- Icon -->
                            <div class="icon-lg text-dark bg-warning rounded-circle flex-shrink-0"><i class="fa-solid fa-ticket"></i></div>
                            <!-- Content -->
                            <div class="ms-3">
                                <h4 class="mb-1">Submit a Ticket</h4>
                                <p class="mb-3">Prosperous impression had conviction For every delay</p>
                                <a href="/support-ticket" class="btn btn-dark mb-0">Submit ticket</a>
                            </div>	
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- =======================
    Action boxes END -->
    
    </main>
    <!-- **************** MAIN CONTENT END **************** -->

<%- include('./partials/footer') %>